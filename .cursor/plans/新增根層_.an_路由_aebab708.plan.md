---
name: 新增根層 .an 路由
overview: ""
todos:
  - id: update-parser
    content: 允許 getSpeechFilename 接受根層 .an 路徑
    status: pending
  - id: route-wire
    content: 新增 /:filename.an 路由指向 speechAn
    status: pending
    dependencies:
      - update-parser
  - id: add-test
    content: 補測試確認兩路徑行為一致
    status: pending
    dependencies:
      - route-wire
---

# 新增根層 .an 路由

- 更新 `getSpeechFilename` 解析邏輯，讓 `/{filename}.an` 也能被接受，同時保留現有 `/api/an/{filename}.an`，確保解碼與副檔名檢查一致，避免空檔名或額外子路徑。
- 在 [src/index.ts](/Users/bestian/Documents/GitHub/sayit-hono/src/index.ts) 新增 `GET/HEAD /:filename.an` 路由並指向 `speechAn`，放在 SSR catch-all 之前，避免被 `/:filename` 或靜態處理攔截。
- 覆蓋或新增測試（若有測試基礎）驗證 `/{filename}.an` 回傳內容與 `/api/an/{filename}.an` 一致，並處理找不到檔名時的 404。
